---
contributors: Jeehut
---
## Intro

This session is about how to build great data visualizations with Swift Charts,

```swift
Chart (data, id: .name) {
	BarMark(
		x: .value ("Sales", $0. sales),
		y: .value ("Name", $0. name)
	)
}
```
![swiftui charts][charts1]

[charts1]: ../../../images/notes/wwdc22/10137/charts1.jpg  

Which can be easily customisable.

![swiftui charts][charts2]

[charts2]: ../../../images/notes/wwdc22/10137/charts2.jpg  

- declarative syntax, like SwiftUI
- create charts by composition

Some examples of charts on the Apple platform:

![swiftui charts][charts3]

[charts3]: ../../../images/notes/wwdc22/10137/charts3.jpg  

- Problem space of chart libraries
  - Data Visualization
  - Communicate Data
  - Accessible
  - Localization
  - Dark Mode
  - Layout
  - Dynamic Type
  - Device Screen Sizes
  - Multi-Platform
  - Animation

# Marks and composition

- a `Mark` is a graphical element that represents data

![swiftui charts][charts4]

[charts4]: ../../../images/notes/wwdc22/10137/charts4.jpg

![swiftui charts][charts5]

[charts5]: ../../../images/notes/wwdc22/10137/charts5.jpg

- `Chart` is a SwiftUI view used as the wrapper for charts

```swift
struct TopStyle: View {
	var body: some View {
		GroupBox ("Most Sold Style") {
			Text ("Cachapa")
			Chart {
				// TODO: Add contents in the chart.
			}
		}
	}
}
```

![swiftui charts][charts5]

[charts5]: ../../../images/notes/wwdc22/10137/charts5.jpg

- This is a chart  with one BarMark
```swift
Chart {
	BarMark(
		x: .value("Sales", 916),
		y: .value ("Name", "Cachapa")
	)
}
```

![swiftui charts][charts6]

[charts6]: ../../../images/notes/wwdc22/10137/charts6.jpg

- Provide multiple `BarMark` views to show multiple bars
- `.foregroundStyle` can be used to specify a color

```swift
let data = [
	(name: "Cachapa", sales: 916), 
	(name: "Injera", sales: 850), 
	(name: "Crêpe", sales: 802),
]

Chart(data, id: \.name) {
	BarMark(
		x: .value ("Sales", $0.sales),
		y: value ("Name", $0. name)
	)
	.foregroundStyle(Color ("barColor"))
}
```

![swiftui charts][charts7]

[charts7]: ../../../images/notes/wwdc22/10137/charts7.jpg

- `.accessisibilityLabel` and `.accessibilityValue` can be used to customize the default VoiceOver value

```swift
Chart(data, id: \.name) {
	BarMark(
		x: .value ("Sales", $0.sales),
		y: value ("Name", $0. name)
	)
	.accessibilityLabel($0.name)
	.accessibilityValue("\($0.sales) sold")
}
```

- Data driven, e.g.:

```swift
let dailySales: [(day: Date, sales: Int)] = [
  (day: /* May 8th */, sales: 168),
  (day: /* May 9th */, sales: 117),
  (day: /* May 10th */, sales: 106),
  ...
]

Chart {
  ForEach(dailySales, id: \.day) {
    BarMark(
      x: .value("Day", $0.day, unit: .day),
      y: .value("Sales", $0.sales)
    )
  }
}
```

![swiftui charts][charts8]

[charts8]: ../../../images/notes/wwdc22/10137/charts8.jpg

- switching chart types is easy, e.g. replace `BarChart` with `LineChart` (or `PointChart`) as in this example with two series of data.

```swift
let cupertinoData: [(weekday: Date, sales: Int)] = [...]
let sfData: [(weekday: Date, sales: Int)] = [...]

let seriesData = [
	(city: "Cupertino", data: cupertinoData), 
	(city: "San Francisco", data: sfData)
]

Chart {
	ForEach(seriesData, id: I.city) { series in
		ForEach(series.data, id: \.month) {
			LineMark(
				x: .value ("Weekday", $0.weekday, unit: .day),
				y: .value("Sales", $0.sales)
			)
		}
		.foregroundStyle(by: value("City", series .city))
		.symbol(by: value("City", series.city))
		.interpolationMethod(.catmullRom)
	}
}
```
![swiftui charts][charts9]

[charts9]: ../../../images/notes/wwdc22/10137/charts9.jpg

- `x` parameter specifies the x-axis, `y` param the y-axis
- use `.foregroundStyle(by: .value("City", series.city)` for automatic coloring
- Use `.symbol(by: .value...)` for different shapes and for accessibility, in case the user is color blind
- Supports `.interpolationMethod(.catmullRom)` for smoothing out the curve
- Supports `.position` for grouping

```swift
	.position (by: .value("City", series.city))
```

![swiftui charts][charts10]

[charts10]: ../../../images/notes/wwdc22/10137/charts10.jpg

## More types of marks

![swiftui charts][charts11]

[charts11]: ../../../images/notes/wwdc22/10137/charts11.jpg

- `AreaMark` with `x:yStart:yEnd` to show a range of data

```swift
let data = [
	(month: /* Jul, 2021 */,
	dailyAverage: 127, 
	dailyMin: 95, 
	dailyMax: 194
	),
	...
]

Chart {
	ForEach(data, id: \.month) {
		AreaMark(
			x: .value ("Month", $0.month, unit: .month), 
			yStart: .value("Daily Min", $0.dailyMin), 
			yEnd: .value("Daily Max", $0.dailyMax)
		)
		.opacity (0.3)
		LineMark(
			x: value("Month", $0.month, unit: .month),
			y: .value ("Daily Average", $0 .dailyAverage)
		)
	}
}
```

![swiftui charts][charts12]

[charts12]: ../../../images/notes/wwdc22/10137/charts12.jpg

- Also works with `BarMark` (to show range of data)
- `RectangleMark` shows distinct marks for mid instead of building a graph in `BarMark`

```swift
let data = [...]

Chart {
	ForEach(data, id: \.month) {
		BarMark(
			x: .value ("Month", $0.month, unit: .month), 
			yStart: .value("Daily Min", $0.dailyMin), 
			yEnd: .value("Daily Max", $0.dailyMax),
			charts13.jpg
		)
		.opacity (0.3)
		RectangleMark(
			x: value("Month", $0.month, unit: .month),
			y: .value ("Daily Average", $0 .dailyAverage),
			width: .ratio(0.6),
			height: 2
		)
	}
}
```

![swiftui charts][charts13]

[charts13]: ../../../images/notes/wwdc22/10137/charts13.jpg

- `RuleMark(y:)` can be used alongside with `.annotation(position:)` for guiding lines

```swift
let data = [...]
let averageValue = 137

Chart {
	ForEach(data, id: \.month) {
		BarMark(...)
		RectangleMark(...)
	}
	.foregroundStyle(.gray.opacity(0.5))
	
	RuleMark(
		y: .value("Average", averageValue)
	)
	.lineStyle(StrokeStyle(lineWidth: 3))
	.annotation(position: •top, alignment: .leading) {
		Text ("Average: \(averageValue, format: .number)")
			.font(.headline)
			.foregroundStyle(.blue)
	}
}
```

![swiftui charts][charts14]

[charts14]: ../../../images/notes/wwdc22/10137/charts14.jpg

Example of different ways to use and combine these basic marks. In order

- box plot  
- multi-series line chart  
- population pyramid  
- range plot  
- stream graph  
- multi-series scatter plot  
- heat map  
- a plot of a vector field

![swiftui charts][charts15]

[charts15]: ../../../images/notes/wwdc22/10137/charts15.jpg


## Plotting data with mark properties

![swiftui charts][charts16]

[charts16]: ../../../images/notes/wwdc22/10137/charts16.jpg

- Data Types
  - Quantitative (Int, Double, Decimal)
  - Nominal (String, Continent, ProductType)
  - Temporal (day: Date, time: Date)

- Quantitative Sales, Nominal Name

![swiftui charts][charts17]

[charts17]: ../../../images/notes/wwdc22/10137/charts17.jpg

- Orientation of the bar depends on where the nominal data is

![swiftui charts][charts18]

[charts18]: ../../../images/notes/wwdc22/10137/charts18.jpg

- Available data marks and properties:

![swiftui charts][charts19]

[charts19]: ../../../images/notes/wwdc22/10137/charts19.jpg

- `scale` is available for all data types, e.g. `yScale`

```swift
func yScale(sales: Int) -> CGFloat {
	return CGFloat(sales) * someFactor + someOffset
}
```

![swiftui charts][charts20]

[charts20]: ../../../images/notes/wwdc22/10137/charts20.jpg

- by default, the lib infers the scales automatically

![swiftui charts][charts21]

[charts21]: ../../../images/notes/wwdc22/10137/charts21.jpg

- Use `.chartYScale(domain:)` modifier to have fixed range of values on the y axis

```swift
Chart {
	ForEach(seriesData, id: \city) { series in
		ForEach(series .weekdays, id: \.month) {
			LineMark(
				x: .value("Weekday", $0.weekday, unit: .day),
				y: value("Sales", $0.sales)
			)
		}
		.foregroundStyle(by: .value("City", series.city)) 
		.symbol(by: value("City", series .city))
	}
}
.chartYScale(domain: 0 ... 200)
```

![swiftui charts][charts22]

[charts22]: ../../../images/notes/wwdc22/10137/charts22.jpg

- use the chartForegroundStyleScale modifier to change the colors of the lines on the chart 

```swift
Chart {
	ForEach(seriesData, id: \city) { series in
		ForEach(series .weekdays, id: \.month) {
			LineMark(
				x: .value("Weekday", $0.weekday, unit: .day),
				y: value("Sales", $0.sales)
			)
		}
		.foregroundStyle(by: .value("City", series.city)) 
		.symbol(by: value("City", series .city))
	}
}
.chartYScale(domain: 0 ... 200)
.chartForegroundStyleScale([
	"San Francisco" : .orange,
	"Cupertino": .pink
])
```

![swiftui charts][charts22]

[charts22]: ../../../images/notes/wwdc22/10137/charts22.jpg

## Customizations
- All elements (axes, legends, plot area) are customizable

![](https://user-images.githubusercontent.com/6942160/172727472-3a566cdf-e5e2-4ea9-a277-c6fca56ab496.png)

- `.chartXAxis {}` with `AxisMarks` inside can be used for custom axis

![](https://user-images.githubusercontent.com/6942160/172727483-4620a79c-2248-40c3-9a51-6a8f992c310b.png)

- Use `AxisGridLine`, `AxisTick` and `AxisValueLabel` with marks

![](https://user-images.githubusercontent.com/6942160/172727494-4f5fc070-f0ac-4116-b99a-9bb0aefe0ced.png)

- also supports `if` kind of conditionals for dynamic axis

![](https://user-images.githubusercontent.com/6942160/172727527-38dd33c5-b9cb-40e2-80e9-93a9648482de.png)

- `AxisMarks` accepts a `position` param, e.g. `.leading`
- `AxisMarks` accepts `preset` param, e.g. `.extended` to align visually with rest of interface
- hide axis via `.chartXAxis(.hidden)` for example
- hide legend via `.chartLegend(.hidden)`
- `.chartPlotStyle {}` to customize plot area
  - e.g., `plotArea.frame(height: 60 * numberOfCategories)`
  - or `plotArea.background(.pink.opacity(0.2))`, any modifiers for views available

- `ChartProxy` can be used to access the `position(forX:)` or `value(atX:)`
  - allows to coordinate other views with chart, e.g. select an interval in the chart with a slider

- `.chartOverlay` modifier provides a `ChartProxy` in the content

```swift
struct InteractiveBrushingChart: View {
  @State var range: (Date, Date)? = nil

  var body: some View {
    Chart { ... }
    .chartOverlay { proxy in
      GeometryReader { nthGeoItem in
        Rectangle().fill(.clear).contentShape(Rectangle())
          .gesture(DragGesture()
            .onChanged { value in
              // Find the x-coordinates in the chart’s plot area.
              let xStart = value.startLocation.x - nthGeoItem[proxy.plotAreaFrame].origin.x
              let xCurrent = value.location.x - nthGeoItem[proxy.plotAreaFrame].origin.x
              // Find the date values at the x-coordinates.
              if let dateStart: Date = proxy.value(atX: xStart),
                 let dateCurrent: Date = proxy.value(atX: xCurrent) {
                range = (dateStart, dateCurrent)
              }
            }
            .onEnded { _ in range = nil } // Clear the state on gesture end.
          )
      }
    }
  }

  // ...
}
```

- the proxy allows to store data in state and drive the chart rendering with that data (e.g. for a hover and show data effect)
