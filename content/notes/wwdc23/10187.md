---
contributors: mikakruschel, multitudes
---

## Chapters
[0:00 - Intro](https://developer.apple.com/wwdc23/10187)  
[1:07 - Using the model macro](https://developer.apple.com/wwdc23/10187?time=67)  
[3:17 - Working with your data](https://developer.apple.com/wwdc23/10187?time=197)  
[7:02 - Use SwiftData with SwiftUI](https://developer.apple.com/wwdc23/10187?time=422)  
[8:10 - Wrap-up](https://developer.apple.com/wwdc23/10187?time=490)  

![SwiftData Logo][SwiftData]  

[SwiftData]: ../../../images/notes/wwdc23/10187/SwiftData.jpg
# Intro
- Using the model macro  
- Working with your data  
- Use SwiftData with SwiftUl  

SwiftData is a powerful framework for data modeling and management and enhances your modern Swift app. Like SwiftUI, it focuses entirely on code with no external file formats and uses Swift's new macro system to create a seamless API experience.

## Using the model macro @Model
- Powerful new Swift macro  
- Define your schema with code  
- Add SwiftData functionality to model types  

@Model is a new Swift macro that helps to define your model's schema from your Swift code. SwiftData schemas are normal Swift code, but when needed, you can annotate your properties with additional metadata. Using this schema, SwiftData adds powerful functionality to your model objects. 

Add `import SwiftData` and **`@Model`** to the model class and the schema is generated.
```swift
// Adding @Model to Trip

import SwiftData

@Model
class Trip {
var name: String 
var destination: String 
var endDate: Date 
var startDate: Date

var bucketList: [BucketListItem]? = []
var livingAccommodation: LivingAccommodation?
}
```

Models in SwiftData are the source of truth for your application's schema and drive the persistence experience. Part of this experience will transform the class' stored properties and turns them into persisted properties. 

SwiftData natively adapts your value type properties to be used as attributes right away. These properties include basic value types, like string, int, and float. They can also include more complex value types, such as structs, enums, and codable types too, including collections.

 SwiftData models reference types as relationships. You can create links between your model types with relationships and collections of model types. @Model will modify all the stored properties on your type. You can influence how SwiftData builds your schema using metadata on your properties. With @Attribute, you can add uniqueness constraints. You can use @Relationship to control the choice of inverses and specify delete propagation rules. These change the behaviors of links between models. You can tell SwiftData not to include specific properties with the Transient macro. Here is our previous Trip example. I'll adjust SwiftData's schema generation by adding metadata to our stored properties.


- types can be value types, enums, structs, codable or collections of the value types
- `@Attribute(.unique)` for uniqueness constraint
- `@Relationship` for choice of inverses and delete propagation rules
- `@Transient` to exclude property from model

## Model container

- Model container provides the persistent backend
  - Create container by specifying the list of model types to store
  - optionally provide `ModelConfiguration` with an url, CloudKit and group container identifiers, and migration options
  - `let container = try ModelContainer(for: [Trip.self, LivingAccommodation.self], configurations: ModelConfiguration(url: URL("path")))`
  - Or in SwiftUI use the modifier `.modelContainer(for: [Trip.self, LivingAccommodation.self])`
- **`ModelContext`**: interface to tracking updates, fetching data, saving changes, and even undoing those changes
  - In SwiftUI: `@Environment(\.modelContext) private var context`
  - `container.mainContext` for shared MainActor bound context
  - `let context = ModelContainer(container)` to instantiate new contexts for a given model container

## Fetching Data

- Use Swift native types `Predicate` and `FetchDescriptor`

```swift
let today = Date()
let tripPredicate = #Predicate<Trip> { 
    $0.destination == "New York" &&
    $0.name.contains("birthday") &&
    $0.startDate > today
}
```

```swift
let descriptor = FetchDescriptor<Trip>(
    sortBy: SortDescriptor(\Trip.name),
    predicate: tripPredicate
)
let trips = try context.fetch(descriptor)
```

- More FetchDescriptor options: relationships to fetch, result limits, exclude unsaved changes and more

## Modifying Data

```swift
var myTrip = Trip(name: "Birthday Trip", destination: "New York")

// Insert a new trip
context.insert(myTrip)

// Delete an existing trip
context.delete(myTrip)

// Manually save changes to the context
try context.save()
```

- The `@Model` macro modifies setters for change tracking and observation

## SwiftData in SwiftUI

- Configure data store with `.modelContainer` which is propagated throughout SwiftUI environment
- Fetching in SwiftUI with **`@Query`**
- No need for `@Published` and SwiftUI automatically updates

```swift
import SwiftUI

struct ContentView: View  {
    @Query(sort: \.startDate, order: .reverse) var trips: [Trip]
    @Environment(\.modelContext) var modelContext
    
    var body: some View {
       NavigationStack() {
          List {
             ForEach(trips) { trip in 
                 // ...
             }
          }
       }
    }
}
```

## Resources
[Adopting SwiftData for a Core Data app](https://developer.apple.com/documentation/coredata/adopting_swiftdata_for_a_core_data_app)  
[Have a question? Ask with tag wwdc2023-10187](https://developer.apple.com/forums/create/question?&tag1=719030&tag2=698030)  
[Search the forums for tag wwdc2023-10187](https://developer.apple.com/forums/tags/wwdc2023-10187)  
[SwiftData](https://developer.apple.com/documentation/SwiftData)

# Related Videos

[Build an app with SwiftData - WWDC23](https://developer.apple.com/videos/play/wwdc2023/10154)  
[Discover Observation in SwiftUI - WWDC23](https://developer.apple.com/videos/play/wwdc2023/10149)  
[Dive deeper into SwiftData - WWDC23](https://developer.apple.com/videos/play/wwdc2023/10196)  
[Migrate to SwiftData - WWDC23](https://developer.apple.com/videos/play/wwdc2023/10189)  
[Model your schema with SwiftData - WWDC23](https://developer.apple.com/videos/play/wwdc2023/10195)  
[Whatâ€™s new in Swift - WWDC23](https://developer.apple.com/videos/play/wwdc2023/10164)  
[Whatâ€™s new in SwiftUI - WWDC23](https://developer.apple.com/videos/play/wwdc2023/10148)  
